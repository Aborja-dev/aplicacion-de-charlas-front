---
import Form from "./Form.astro";
import Field from "./Field.astro";
---

<Form title="Iniciar sesion" description="introduce tu usario y contraseña">
    <Field name="email" label="Correo Electronico" >
        <input
        type="text"
        id="email"
        name="email"
        class="form-input"
        placeholder="example@gmail.com"
    />
    </Field>
    <Field name="password" label="Contraseña" >
        <input
        type="text"
        id="password"
        name="password"
        class="form-input"
        placeholder=""
    />
    </Field>
    <button type="submit" class="w-full bg-yellow-500 text-white py-2 px-4 rounded-md hover:bg-yellow-600 transition-all duration-300 orbitron">Iniciar sesion</button>
</Form>
<style>
    .form-input {
        background-color: #111827;
        color: #d1d5db;
        border: 1px solid #374151;
        padding: 0.75rem;
        border-radius: 0.5rem;
        width: 100%;
        outline: none;
        transition: all 0.2s;
    }
    .form-input:focus {
        border-color: #fbbf24;
        box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.5);
    }
    .form-label {
        font-weight: 500;
        color: #9ca3af;
        margin-bottom: 0.5rem;
        display: block;
    }
</style>
<script>
import { loginRequest } from "../../lib/gateway";

    const form = document.querySelector("form");
    if (!form) throw new Error("Form not found");
    form.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        console.log("Form data: ", formData);
        
        const email = formData.get("email") as string;
        const password = formData.get("password") as string;
        if (!email || !password)
            throw new Error("Email and password are required");
        try {
            loginRequest({ email, password }).then((response) => {
                window.location.href = "/candidate/home";
            });
        } catch (error) {
            console.error(error);
        }
    });
</script>
